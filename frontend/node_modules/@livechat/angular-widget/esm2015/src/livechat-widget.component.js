import { __decorate } from "tslib";
import { Component, Input, Output } from '@angular/core';
import { Subject } from 'rxjs';
let LivechatWidgetComponent = class LivechatWidgetComponent {
    constructor() {
        this.onChatLoaded = new Subject();
        this.onAfterLoad = new Subject();
        this.onBeforeLoad = new Subject();
        this.onChatEnded = new Subject();
        this.onChatStarted = new Subject();
        this.onChatStateChanged = new Subject();
        this.onChatWindowHidden = new Subject();
        this.onChatWindowMinimized = new Subject();
        this.onChatWindowOpened = new Subject();
        this.onMessage = new Subject();
        this.onPostchatSurveySubmitted = new Subject();
        this.onPrechatSurveySubmitted = new Subject();
        this.onRatingCommentSubmitted = new Subject();
        this.onRatingSubmitted = new Subject();
        this.onTicketCreated = new Subject();
        this.onWidgetResize = new Subject();
    }
    ngOnInit() {
        if (!window['LC_API']) {
            window['__lc'] = window['__lc'] || {};
            window['__lc'].license = this.licenseId;
            window['__lc'].group = this.group;
            window['__lc'].chat_between_groups = this.chatBetweenGroups;
            window['__lc'].params = this.params;
            window['__lc'].visitor = this.visitor;
            window['__lc'].ga_version = this.gaVersion;
            const api = { _q: [], _h: null, call: (...args) => api._h && api._h.apply(null, ['call', [].slice.call(args)]) };
            window['LiveChatWidget'] = api;
            this.lc = document.createElement('script');
            this.lc.type = 'text/javascript';
            this.lc.async = true;
            this.lc.src = 'https://cdn.livechatinc.com/tracking.js';
            const s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(this.lc, s);
            this.lc.addEventListener('load', () => {
                this._chatLoaded(window['LC_API']);
            });
            this.lc.addEventListener('error', (error) => {
                console.error(error);
            });
        }
    }
    ngOnDestroy() {
        if (window['LiveChatWidget'] && typeof window['LiveChatWidget'].call === 'function') {
            window['LiveChatWidget'].call('destroy');
            this.lc && this.lc.remove();
            ['secure.livechat.com', 'secure.livechatinc.com'].forEach(domain => {
                Array.from(document.querySelectorAll(`[src*="${domain}"]`)).forEach(s => s.remove());
            });
        }
    }
    _chatLoaded(LC_API) {
        this._setCallbacks(LC_API);
        this._setMethods(LC_API);
        this.onChatLoaded.next(LC_API);
    }
    _setCallbacks(LC_API) {
        LC_API.on_after_load = () => this.onAfterLoad.next();
        LC_API.on_before_load = () => this.onBeforeLoad.next();
        LC_API.on_chat_ended = () => this.onChatEnded.next();
        LC_API.on_chat_started = (data) => this.onChatStarted.next(data);
        LC_API.on_chat_state_changed = (data) => this.onChatStateChanged.next(data);
        LC_API.on_chat_window_hidden = () => this.onChatWindowHidden.next();
        LC_API.on_chat_window_minimized = () => this.onChatWindowMinimized.next();
        LC_API.on_chat_window_opened = () => this.onChatWindowOpened.next();
        LC_API.on_message = (data) => this.onMessage.next(data);
        LC_API.on_postchat_survey_submitted = (data) => this.onPostchatSurveySubmitted.next(data);
        LC_API.on_prechat_survey_submitted = (data) => this.onPrechatSurveySubmitted.next(data);
        LC_API.on_rating_comment_submitted = (data) => this.onRatingCommentSubmitted.next(data);
        LC_API.on_rating_submitted = (data) => this.onRatingSubmitted.next(data);
        LC_API.on_ticket_created = (data) => this.onTicketCreated.next(data);
    }
    _setMethods(LC_API) {
        this.agentsAreAvailable = () => LC_API.agents_are_available();
        this.chatRunning = () => LC_API.chat_running();
        this.chatWindowHidden = () => LC_API.chat_window_hidden();
        this.chatWindowMaximized = () => LC_API.chat_window_maximized();
        this.chatWindowMinimized = () => LC_API.chat_window_minimized();
        this.closeChat = () => LC_API.close_chat();
        this.getChatId = () => LC_API.get_chat_id();
        this.getChatsNumber = () => LC_API.get_chats_number();
        this.getLastVisitTimestamp = () => LC_API.get_last_visit_timestamp();
        this.getPageViewsNumber = () => LC_API.get_page_views_number();
        this.getVisitorId = () => LC_API.get_visitor_id();
        this.getVisitsNumber = () => LC_API.get_visits_number();
        this.hideChatWindow = () => LC_API.hide_chat_window();
        this.minimizeChatWindow = () => LC_API.minimize_chat_window();
        this.openChatWindow = () => LC_API.open_chat_window();
        this.setCustomVariables = (t) => LC_API.set_custom_variables(t);
        this.setVisitorEmail = (t) => LC_API.set_visitor_email(t);
        this.setVisitorName = (t) => LC_API.set_visitor_name(t);
        this.triggerSalesTracker = (e, t) => LC_API.trigger_sales_tracker(e, t);
        this.updateCustomVariables = (t) => LC_API.update_custom_variables(t);
        this.visitorEngaged = () => LC_API.visitor_engaged();
        this.visitorQueued = () => LC_API.visitor_queued();
    }
};
__decorate([
    Input()
], LivechatWidgetComponent.prototype, "licenseId", void 0);
__decorate([
    Input()
], LivechatWidgetComponent.prototype, "group", void 0);
__decorate([
    Input()
], LivechatWidgetComponent.prototype, "chatBetweenGroups", void 0);
__decorate([
    Input()
], LivechatWidgetComponent.prototype, "params", void 0);
__decorate([
    Input()
], LivechatWidgetComponent.prototype, "visitor", void 0);
__decorate([
    Input()
], LivechatWidgetComponent.prototype, "gaVersion", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onChatLoaded", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onAfterLoad", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onBeforeLoad", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onChatEnded", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onChatStarted", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onChatStateChanged", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onChatWindowHidden", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onChatWindowMinimized", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onChatWindowOpened", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onMessage", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onPostchatSurveySubmitted", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onPrechatSurveySubmitted", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onRatingCommentSubmitted", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onRatingSubmitted", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onTicketCreated", void 0);
__decorate([
    Output()
], LivechatWidgetComponent.prototype, "onWidgetResize", void 0);
LivechatWidgetComponent = __decorate([
    Component({
        selector: 'livechat-widget',
        template: ``
    })
], LivechatWidgetComponent);
export { LivechatWidgetComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZWNoYXQtd2lkZ2V0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BsaXZlY2hhdC9hbmd1bGFyLXdpZGdldC8iLCJzb3VyY2VzIjpbInNyYy9saXZlY2hhdC13aWRnZXQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFakUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQU8vQixJQUFhLHVCQUF1QixHQUFwQyxNQUFhLHVCQUF1QjtJQWdEbEM7UUF6Q2lCLGlCQUFZLEdBQUcsSUFBSSxPQUFPLEVBQTBCLENBQUM7UUFDckQsZ0JBQVcsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO1FBQzVCLGlCQUFZLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQztRQUM3QixnQkFBVyxHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7UUFDNUIsa0JBQWEsR0FBRyxJQUFJLE9BQU8sRUFBTyxDQUFDO1FBQ25DLHVCQUFrQixHQUFHLElBQUksT0FBTyxFQUFPLENBQUM7UUFDeEMsdUJBQWtCLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQztRQUNuQywwQkFBcUIsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO1FBQ3RDLHVCQUFrQixHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7UUFDbkMsY0FBUyxHQUFHLElBQUksT0FBTyxFQUFPLENBQUM7UUFDL0IsOEJBQXlCLEdBQUcsSUFBSSxPQUFPLEVBQU8sQ0FBQztRQUMvQyw2QkFBd0IsR0FBRyxJQUFJLE9BQU8sRUFBTyxDQUFDO1FBQzlDLDZCQUF3QixHQUFHLElBQUksT0FBTyxFQUFPLENBQUM7UUFDOUMsc0JBQWlCLEdBQUcsSUFBSSxPQUFPLEVBQU8sQ0FBQztRQUN2QyxvQkFBZSxHQUFHLElBQUksT0FBTyxFQUFPLENBQUM7UUFDckMsbUJBQWMsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO0lBMEJoQyxDQUFDO0lBRWpCLFFBQVE7UUFDTixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQ3JCLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3RDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUN4QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztZQUM1RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7WUFDcEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ3RDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUMzQyxNQUFNLEdBQUcsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxHQUFHLElBQUksRUFBRSxFQUFFLENBQUUsR0FBRyxDQUFDLEVBQUUsSUFBSSxHQUFHLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFHLENBQUM7WUFDbkgsTUFBTSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsR0FBRyxDQUFDO1lBQy9CLElBQUksQ0FBQyxFQUFFLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMzQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksR0FBRyxpQkFBaUIsQ0FBQztZQUNqQyxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7WUFDckIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcseUNBQXlDLENBQUM7WUFDeEQsTUFBTSxDQUFDLEdBQUcsUUFBUSxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JELENBQUMsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdEMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFO2dCQUNwQyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQ3JDLENBQUMsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtnQkFDMUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN2QixDQUFDLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQztJQUVELFdBQVc7UUFDVCxJQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLE9BQU8sTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUMsSUFBSSxLQUFLLFVBQVUsRUFBRTtZQUNsRixNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDekMsSUFBSSxDQUFDLEVBQUUsSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQzVCLENBQUMscUJBQXFCLEVBQUUsd0JBQXdCLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQ2pFLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLFVBQVUsTUFBTSxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO1lBQ3RGLENBQUMsQ0FBQyxDQUFBO1NBQ0g7SUFDSCxDQUFDO0lBRU8sV0FBVyxDQUFDLE1BQThCO1FBQ2hELElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDM0IsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN6QixJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRU8sYUFBYSxDQUFDLE1BQThCO1FBQ2xELE1BQU0sQ0FBQyxhQUFhLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNyRCxNQUFNLENBQUMsY0FBYyxHQUFHLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDdkQsTUFBTSxDQUFDLGFBQWEsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3JELE1BQU0sQ0FBQyxlQUFlLEdBQUcsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2pFLE1BQU0sQ0FBQyxxQkFBcUIsR0FBRyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1RSxNQUFNLENBQUMscUJBQXFCLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3BFLE1BQU0sQ0FBQyx3QkFBd0IsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDMUUsTUFBTSxDQUFDLHFCQUFxQixHQUFHLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNwRSxNQUFNLENBQUMsVUFBVSxHQUFHLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4RCxNQUFNLENBQUMsNEJBQTRCLEdBQUcsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUYsTUFBTSxDQUFDLDJCQUEyQixHQUFHLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsd0JBQXdCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hGLE1BQU0sQ0FBQywyQkFBMkIsR0FBRyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4RixNQUFNLENBQUMsbUJBQW1CLEdBQUcsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDekUsTUFBTSxDQUFDLGlCQUFpQixHQUFHLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2RSxDQUFDO0lBRU8sV0FBVyxDQUFDLE1BQThCO1FBQ2hELElBQUksQ0FBQyxrQkFBa0IsR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUM5RCxJQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUMvQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDMUQsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1FBQ2hFLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUNoRSxJQUFJLENBQUMsU0FBUyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUMzQyxJQUFJLENBQUMsU0FBUyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUM1QyxJQUFJLENBQUMsY0FBYyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3RELElBQUksQ0FBQyxxQkFBcUIsR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztRQUNyRSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLHFCQUFxQixFQUFFLENBQUM7UUFDL0QsSUFBSSxDQUFDLFlBQVksR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDbEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUN4RCxJQUFJLENBQUMsY0FBYyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3RELElBQUksQ0FBQyxrQkFBa0IsR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUM5RCxJQUFJLENBQUMsY0FBYyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3RELElBQUksQ0FBQyxrQkFBa0IsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2hFLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxRCxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDeEQsSUFBSSxDQUFDLG1CQUFtQixHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMscUJBQXFCLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0RSxJQUFJLENBQUMsY0FBYyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUNyRCxJQUFJLENBQUMsYUFBYSxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUNyRCxDQUFDO0NBQ0YsQ0FBQTtBQXBJVTtJQUFSLEtBQUssRUFBRTswREFBbUI7QUFDbEI7SUFBUixLQUFLLEVBQUU7c0RBQWU7QUFDZDtJQUFSLEtBQUssRUFBRTtrRUFBNEI7QUFDM0I7SUFBUixLQUFLLEVBQUU7dURBQXNDO0FBQ3JDO0lBQVIsS0FBSyxFQUFFO3dEQUEyQztBQUMxQztJQUFSLEtBQUssRUFBRTswREFBbUI7QUFDakI7SUFBVCxNQUFNLEVBQUU7NkRBQTZEO0FBQzVEO0lBQVQsTUFBTSxFQUFFOzREQUFvQztBQUNuQztJQUFULE1BQU0sRUFBRTs2REFBcUM7QUFDcEM7SUFBVCxNQUFNLEVBQUU7NERBQW9DO0FBQ25DO0lBQVQsTUFBTSxFQUFFOzhEQUEyQztBQUMxQztJQUFULE1BQU0sRUFBRTttRUFBZ0Q7QUFDL0M7SUFBVCxNQUFNLEVBQUU7bUVBQTJDO0FBQzFDO0lBQVQsTUFBTSxFQUFFO3NFQUE4QztBQUM3QztJQUFULE1BQU0sRUFBRTttRUFBMkM7QUFDMUM7SUFBVCxNQUFNLEVBQUU7MERBQXVDO0FBQ3RDO0lBQVQsTUFBTSxFQUFFOzBFQUF1RDtBQUN0RDtJQUFULE1BQU0sRUFBRTt5RUFBc0Q7QUFDckQ7SUFBVCxNQUFNLEVBQUU7eUVBQXNEO0FBQ3JEO0lBQVQsTUFBTSxFQUFFO2tFQUErQztBQUM5QztJQUFULE1BQU0sRUFBRTtnRUFBNkM7QUFDNUM7SUFBVCxNQUFNLEVBQUU7K0RBQXVDO0FBdEJyQyx1QkFBdUI7SUFMbkMsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLGlCQUFpQjtRQUMzQixRQUFRLEVBQUUsRUFBRTtLQUViLENBQUM7R0FDVyx1QkFBdUIsQ0FxSW5DO1NBcklZLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT3V0cHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBMaXZlQ2hhdFdpZGdldEFwaU1vZGVsIH0gZnJvbSAnLi9saXZlY2hhdC13aWRnZXQubW9kZWxzJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbGl2ZWNoYXQtd2lkZ2V0JyxcbiAgdGVtcGxhdGU6IGBgLFxuICBzdHlsZXM6IFtdXG59KVxuZXhwb3J0IGNsYXNzIExpdmVjaGF0V2lkZ2V0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KCkgbGljZW5zZUlkOiBudW1iZXI7XG4gIEBJbnB1dCgpIGdyb3VwOiBudW1iZXI7XG4gIEBJbnB1dCgpIGNoYXRCZXR3ZWVuR3JvdXBzOiBib29sZWFuO1xuICBASW5wdXQoKSBwYXJhbXM6IHsgbmFtZTogc3RyaW5nLCB2YWx1ZTogYW55IH07XG4gIEBJbnB1dCgpIHZpc2l0b3I6IHsgbmFtZTogc3RyaW5nLCBlbWFpbDogc3RyaW5nLCB9O1xuICBASW5wdXQoKSBnYVZlcnNpb246IHN0cmluZztcbiAgQE91dHB1dCgpIHB1YmxpYyBvbkNoYXRMb2FkZWQgPSBuZXcgU3ViamVjdDxMaXZlQ2hhdFdpZGdldEFwaU1vZGVsPigpO1xuICBAT3V0cHV0KCkgcHVibGljIG9uQWZ0ZXJMb2FkID0gbmV3IFN1YmplY3QoKTtcbiAgQE91dHB1dCgpIHB1YmxpYyBvbkJlZm9yZUxvYWQgPSBuZXcgU3ViamVjdCgpO1xuICBAT3V0cHV0KCkgcHVibGljIG9uQ2hhdEVuZGVkID0gbmV3IFN1YmplY3QoKTtcbiAgQE91dHB1dCgpIHB1YmxpYyBvbkNoYXRTdGFydGVkID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICBAT3V0cHV0KCkgcHVibGljIG9uQ2hhdFN0YXRlQ2hhbmdlZCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgQE91dHB1dCgpIHB1YmxpYyBvbkNoYXRXaW5kb3dIaWRkZW4gPSBuZXcgU3ViamVjdCgpO1xuICBAT3V0cHV0KCkgcHVibGljIG9uQ2hhdFdpbmRvd01pbmltaXplZCA9IG5ldyBTdWJqZWN0KCk7XG4gIEBPdXRwdXQoKSBwdWJsaWMgb25DaGF0V2luZG93T3BlbmVkID0gbmV3IFN1YmplY3QoKTsgZGF0YVxuICBAT3V0cHV0KCkgcHVibGljIG9uTWVzc2FnZSA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgQE91dHB1dCgpIHB1YmxpYyBvblBvc3RjaGF0U3VydmV5U3VibWl0dGVkID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICBAT3V0cHV0KCkgcHVibGljIG9uUHJlY2hhdFN1cnZleVN1Ym1pdHRlZCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgQE91dHB1dCgpIHB1YmxpYyBvblJhdGluZ0NvbW1lbnRTdWJtaXR0ZWQgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gIEBPdXRwdXQoKSBwdWJsaWMgb25SYXRpbmdTdWJtaXR0ZWQgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gIEBPdXRwdXQoKSBwdWJsaWMgb25UaWNrZXRDcmVhdGVkID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICBAT3V0cHV0KCkgcHVibGljIG9uV2lkZ2V0UmVzaXplID0gbmV3IFN1YmplY3QoKTtcblxuICBwdWJsaWMgYWdlbnRzQXJlQXZhaWxhYmxlOiBGdW5jdGlvbjtcbiAgcHVibGljIGNoYXRSdW5uaW5nOiBGdW5jdGlvbjtcbiAgcHVibGljIGNoYXRXaW5kb3dIaWRkZW46IEZ1bmN0aW9uO1xuICBwdWJsaWMgY2hhdFdpbmRvd01heGltaXplZDogRnVuY3Rpb247XG4gIHB1YmxpYyBjaGF0V2luZG93TWluaW1pemVkOiBGdW5jdGlvbjtcbiAgcHVibGljIGNsb3NlQ2hhdDogRnVuY3Rpb247XG4gIHB1YmxpYyBnZXRDaGF0SWQ6IEZ1bmN0aW9uO1xuICBwdWJsaWMgZ2V0Q2hhdHNOdW1iZXI6IEZ1bmN0aW9uO1xuICBwdWJsaWMgZ2V0TGFzdFZpc2l0VGltZXN0YW1wOiBGdW5jdGlvbjtcbiAgcHVibGljIGdldFBhZ2VWaWV3c051bWJlcjogRnVuY3Rpb247XG4gIHB1YmxpYyBnZXRWaXNpdG9ySWQ6IEZ1bmN0aW9uO1xuICBwdWJsaWMgZ2V0VmlzaXRzTnVtYmVyOiBGdW5jdGlvbjtcbiAgcHVibGljIGhpZGVDaGF0V2luZG93OiBGdW5jdGlvbjtcbiAgcHVibGljIG1pbmltaXplQ2hhdFdpbmRvdzogRnVuY3Rpb247XG4gIHB1YmxpYyBvcGVuQ2hhdFdpbmRvdzogRnVuY3Rpb247XG4gIHB1YmxpYyBzZXRDdXN0b21WYXJpYWJsZXM6IEZ1bmN0aW9uO1xuICBwdWJsaWMgc2V0VmlzaXRvckVtYWlsOiBGdW5jdGlvbjtcbiAgcHVibGljIHNldFZpc2l0b3JOYW1lOiBGdW5jdGlvbjtcbiAgcHVibGljIHRyaWdnZXJTYWxlc1RyYWNrZXI6IEZ1bmN0aW9uO1xuICBwdWJsaWMgdXBkYXRlQ3VzdG9tVmFyaWFibGVzOiBGdW5jdGlvbjtcbiAgcHVibGljIHZpc2l0b3JFbmdhZ2VkOiBGdW5jdGlvbjtcbiAgcHVibGljIHZpc2l0b3JRdWV1ZWQ6IEZ1bmN0aW9uO1xuICBwcml2YXRlIGxjOiBIVE1MU2NyaXB0RWxlbWVudDtcblxuICBjb25zdHJ1Y3RvcigpIHsgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICghd2luZG93WydMQ19BUEknXSkge1xuICAgICAgd2luZG93WydfX2xjJ10gPSB3aW5kb3dbJ19fbGMnXSB8fCB7fTtcbiAgICAgIHdpbmRvd1snX19sYyddLmxpY2Vuc2UgPSB0aGlzLmxpY2Vuc2VJZDtcbiAgICAgIHdpbmRvd1snX19sYyddLmdyb3VwID0gdGhpcy5ncm91cDtcbiAgICAgIHdpbmRvd1snX19sYyddLmNoYXRfYmV0d2Vlbl9ncm91cHMgPSB0aGlzLmNoYXRCZXR3ZWVuR3JvdXBzO1xuICAgICAgd2luZG93WydfX2xjJ10ucGFyYW1zID0gdGhpcy5wYXJhbXM7XG4gICAgICB3aW5kb3dbJ19fbGMnXS52aXNpdG9yID0gdGhpcy52aXNpdG9yO1xuICAgICAgd2luZG93WydfX2xjJ10uZ2FfdmVyc2lvbiA9IHRoaXMuZ2FWZXJzaW9uO1xuICAgICAgY29uc3QgYXBpID0geyBfcTogW10sIF9oOiBudWxsLCBjYWxsOiAoLi4uYXJncykgPT4gIGFwaS5faCAmJiBhcGkuX2guYXBwbHkobnVsbCwgWydjYWxsJywgW10uc2xpY2UuY2FsbChhcmdzKV0pICB9O1xuICAgICAgd2luZG93WydMaXZlQ2hhdFdpZGdldCddID0gYXBpO1xuICAgICAgdGhpcy5sYyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgdGhpcy5sYy50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7XG4gICAgICB0aGlzLmxjLmFzeW5jID0gdHJ1ZTtcbiAgICAgIHRoaXMubGMuc3JjID0gJ2h0dHBzOi8vY2RuLmxpdmVjaGF0aW5jLmNvbS90cmFja2luZy5qcyc7XG4gICAgICBjb25zdCBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdO1xuICAgICAgcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmxjLCBzKTtcbiAgICAgIHRoaXMubGMuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hhdExvYWRlZCh3aW5kb3dbJ0xDX0FQSSddKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5sYy5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCl7XG4gICAgaWYod2luZG93WydMaXZlQ2hhdFdpZGdldCddICYmIHR5cGVvZiB3aW5kb3dbJ0xpdmVDaGF0V2lkZ2V0J10uY2FsbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgd2luZG93WydMaXZlQ2hhdFdpZGdldCddLmNhbGwoJ2Rlc3Ryb3knKTtcbiAgICAgIHRoaXMubGMgJiYgdGhpcy5sYy5yZW1vdmUoKTtcbiAgICAgIFsnc2VjdXJlLmxpdmVjaGF0LmNvbScsICdzZWN1cmUubGl2ZWNoYXRpbmMuY29tJ10uZm9yRWFjaChkb21haW4gPT4ge1xuICAgICAgICBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFtzcmMqPVwiJHtkb21haW59XCJdYCkpLmZvckVhY2gocyA9PiBzLnJlbW92ZSgpKVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9jaGF0TG9hZGVkKExDX0FQSTogTGl2ZUNoYXRXaWRnZXRBcGlNb2RlbCkge1xuICAgIHRoaXMuX3NldENhbGxiYWNrcyhMQ19BUEkpO1xuICAgIHRoaXMuX3NldE1ldGhvZHMoTENfQVBJKTtcbiAgICB0aGlzLm9uQ2hhdExvYWRlZC5uZXh0KExDX0FQSSk7XG4gIH1cblxuICBwcml2YXRlIF9zZXRDYWxsYmFja3MoTENfQVBJOiBMaXZlQ2hhdFdpZGdldEFwaU1vZGVsKSB7XG4gICAgTENfQVBJLm9uX2FmdGVyX2xvYWQgPSAoKSA9PiB0aGlzLm9uQWZ0ZXJMb2FkLm5leHQoKTtcbiAgICBMQ19BUEkub25fYmVmb3JlX2xvYWQgPSAoKSA9PiB0aGlzLm9uQmVmb3JlTG9hZC5uZXh0KCk7XG4gICAgTENfQVBJLm9uX2NoYXRfZW5kZWQgPSAoKSA9PiB0aGlzLm9uQ2hhdEVuZGVkLm5leHQoKTtcbiAgICBMQ19BUEkub25fY2hhdF9zdGFydGVkID0gKGRhdGEpID0+IHRoaXMub25DaGF0U3RhcnRlZC5uZXh0KGRhdGEpO1xuICAgIExDX0FQSS5vbl9jaGF0X3N0YXRlX2NoYW5nZWQgPSAoZGF0YSkgPT4gdGhpcy5vbkNoYXRTdGF0ZUNoYW5nZWQubmV4dChkYXRhKTtcbiAgICBMQ19BUEkub25fY2hhdF93aW5kb3dfaGlkZGVuID0gKCkgPT4gdGhpcy5vbkNoYXRXaW5kb3dIaWRkZW4ubmV4dCgpO1xuICAgIExDX0FQSS5vbl9jaGF0X3dpbmRvd19taW5pbWl6ZWQgPSAoKSA9PiB0aGlzLm9uQ2hhdFdpbmRvd01pbmltaXplZC5uZXh0KCk7XG4gICAgTENfQVBJLm9uX2NoYXRfd2luZG93X29wZW5lZCA9ICgpID0+IHRoaXMub25DaGF0V2luZG93T3BlbmVkLm5leHQoKTtcbiAgICBMQ19BUEkub25fbWVzc2FnZSA9IChkYXRhKSA9PiB0aGlzLm9uTWVzc2FnZS5uZXh0KGRhdGEpO1xuICAgIExDX0FQSS5vbl9wb3N0Y2hhdF9zdXJ2ZXlfc3VibWl0dGVkID0gKGRhdGEpID0+IHRoaXMub25Qb3N0Y2hhdFN1cnZleVN1Ym1pdHRlZC5uZXh0KGRhdGEpO1xuICAgIExDX0FQSS5vbl9wcmVjaGF0X3N1cnZleV9zdWJtaXR0ZWQgPSAoZGF0YSkgPT4gdGhpcy5vblByZWNoYXRTdXJ2ZXlTdWJtaXR0ZWQubmV4dChkYXRhKTtcbiAgICBMQ19BUEkub25fcmF0aW5nX2NvbW1lbnRfc3VibWl0dGVkID0gKGRhdGEpID0+IHRoaXMub25SYXRpbmdDb21tZW50U3VibWl0dGVkLm5leHQoZGF0YSk7XG4gICAgTENfQVBJLm9uX3JhdGluZ19zdWJtaXR0ZWQgPSAoZGF0YSkgPT4gdGhpcy5vblJhdGluZ1N1Ym1pdHRlZC5uZXh0KGRhdGEpO1xuICAgIExDX0FQSS5vbl90aWNrZXRfY3JlYXRlZCA9IChkYXRhKSA9PiB0aGlzLm9uVGlja2V0Q3JlYXRlZC5uZXh0KGRhdGEpO1xuICB9XG5cbiAgcHJpdmF0ZSBfc2V0TWV0aG9kcyhMQ19BUEk6IExpdmVDaGF0V2lkZ2V0QXBpTW9kZWwpIHtcbiAgICB0aGlzLmFnZW50c0FyZUF2YWlsYWJsZSA9ICgpID0+IExDX0FQSS5hZ2VudHNfYXJlX2F2YWlsYWJsZSgpO1xuICAgIHRoaXMuY2hhdFJ1bm5pbmcgPSAoKSA9PiBMQ19BUEkuY2hhdF9ydW5uaW5nKCk7XG4gICAgdGhpcy5jaGF0V2luZG93SGlkZGVuID0gKCkgPT4gTENfQVBJLmNoYXRfd2luZG93X2hpZGRlbigpO1xuICAgIHRoaXMuY2hhdFdpbmRvd01heGltaXplZCA9ICgpID0+IExDX0FQSS5jaGF0X3dpbmRvd19tYXhpbWl6ZWQoKTtcbiAgICB0aGlzLmNoYXRXaW5kb3dNaW5pbWl6ZWQgPSAoKSA9PiBMQ19BUEkuY2hhdF93aW5kb3dfbWluaW1pemVkKCk7XG4gICAgdGhpcy5jbG9zZUNoYXQgPSAoKSA9PiBMQ19BUEkuY2xvc2VfY2hhdCgpO1xuICAgIHRoaXMuZ2V0Q2hhdElkID0gKCkgPT4gTENfQVBJLmdldF9jaGF0X2lkKCk7XG4gICAgdGhpcy5nZXRDaGF0c051bWJlciA9ICgpID0+IExDX0FQSS5nZXRfY2hhdHNfbnVtYmVyKCk7XG4gICAgdGhpcy5nZXRMYXN0VmlzaXRUaW1lc3RhbXAgPSAoKSA9PiBMQ19BUEkuZ2V0X2xhc3RfdmlzaXRfdGltZXN0YW1wKCk7XG4gICAgdGhpcy5nZXRQYWdlVmlld3NOdW1iZXIgPSAoKSA9PiBMQ19BUEkuZ2V0X3BhZ2Vfdmlld3NfbnVtYmVyKCk7XG4gICAgdGhpcy5nZXRWaXNpdG9ySWQgPSAoKSA9PiBMQ19BUEkuZ2V0X3Zpc2l0b3JfaWQoKTtcbiAgICB0aGlzLmdldFZpc2l0c051bWJlciA9ICgpID0+IExDX0FQSS5nZXRfdmlzaXRzX251bWJlcigpO1xuICAgIHRoaXMuaGlkZUNoYXRXaW5kb3cgPSAoKSA9PiBMQ19BUEkuaGlkZV9jaGF0X3dpbmRvdygpO1xuICAgIHRoaXMubWluaW1pemVDaGF0V2luZG93ID0gKCkgPT4gTENfQVBJLm1pbmltaXplX2NoYXRfd2luZG93KCk7XG4gICAgdGhpcy5vcGVuQ2hhdFdpbmRvdyA9ICgpID0+IExDX0FQSS5vcGVuX2NoYXRfd2luZG93KCk7XG4gICAgdGhpcy5zZXRDdXN0b21WYXJpYWJsZXMgPSAodCkgPT4gTENfQVBJLnNldF9jdXN0b21fdmFyaWFibGVzKHQpO1xuICAgIHRoaXMuc2V0VmlzaXRvckVtYWlsID0gKHQpID0+IExDX0FQSS5zZXRfdmlzaXRvcl9lbWFpbCh0KTtcbiAgICB0aGlzLnNldFZpc2l0b3JOYW1lID0gKHQpID0+IExDX0FQSS5zZXRfdmlzaXRvcl9uYW1lKHQpO1xuICAgIHRoaXMudHJpZ2dlclNhbGVzVHJhY2tlciA9IChlLCB0KSA9PiBMQ19BUEkudHJpZ2dlcl9zYWxlc190cmFja2VyKGUsIHQpO1xuICAgIHRoaXMudXBkYXRlQ3VzdG9tVmFyaWFibGVzID0gKHQpID0+IExDX0FQSS51cGRhdGVfY3VzdG9tX3ZhcmlhYmxlcyh0KTtcbiAgICB0aGlzLnZpc2l0b3JFbmdhZ2VkID0gKCkgPT4gTENfQVBJLnZpc2l0b3JfZW5nYWdlZCgpO1xuICAgIHRoaXMudmlzaXRvclF1ZXVlZCA9ICgpID0+IExDX0FQSS52aXNpdG9yX3F1ZXVlZCgpO1xuICB9XG59XG4iXX0=